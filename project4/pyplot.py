import numpy as np
from numpy import polyfit, polyval
import matplotlib.pyplot as plt
from matplotlib.font_manager import FontProperties

x=[8,16,32,64,128,256,512,1024,2048,4096,8192,
16384,32768,65536,131072,262144,524288,1048576,
2097152,4194304,8388608,16777216,33554432,67108864,
134217728,268435456,536870912,1073741824]

fx=[0.000155790,0.000064797,0.000066676,0.000065391,
0.000069023,0.000075657,0.000077293,0.000086790,
0.000109473,0.000111127,0.000162719,0.000269301,
0.000490843,0.000964245,0.001691522,0.002657966,
0.004822254,0.009375662,0.018491602,0.036611318,
0.074251618,0.145586399,0.289251281,0.576924388,
1.153087107,2.305725516,4.973745859,12.706872627]

fxx=[0.000000393,0.000000225,0.000000237,0.000000233,
0.000000285,0.000000302,0.000000465,0.000000509,
0.000000591,0.000001897,0.000002520,0.000003772,
0.000004499,0.000006888,0.000012354,0.000021218,
0.000160580,0.000082783,0.000305562,0.001252492,
0.003046612,0.006198350,0.011998517,0.014917595,
0.033388194,0.065172487,0.135023906,0.263032241]

# fx=[0.000097439,0.000058283,0.000063626,0.000076496,
# 0.000092164,0.000077622,0.000085228,0.000085958,
# 0.000110836,0.000114791,0.000163266,0.000238031,
# 0.000452818,0.000968423,0.001429685,0.002610900,
# 0.004777429,0.009591260,0.018544808,0.036662083,
# 0.072626992,0.144655004,0.288689180,0.576923326,
# 1.152937170,2.306002344,4.973745859,9.947491718]

# https://www.youtube.com/watch?v=9Dui-ExAEEc

p=polyfit(x,fx,1)
q=polyfit(x,fxx,1)

px=np.linspace(0,1150000000)
py=polyval(p,px)
plt.figure
plt.plot(x,fx,'go')
plt.plot(px,py,'b')
plt.grid (True)
plt.show()

qx=np.linspace(0,1150000000)
qy=polyval(q,qx)
plt.figure
plt.plot(x,fxx,'go')
plt.plot(qx,qy,'b')
plt.grid (True)
plt.show()

print(p)
print(q)
print(1/1.12413907e-08)
print(1/2.45846059e-10)